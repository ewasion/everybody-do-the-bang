<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>EVERYBODY DO THE !BANG</title>
    <script src="bangs.min.js"></script>
    <style>::placeholder{text-align:center;}</style>
  </head>
  <body>
    <form method="get" action="https://duckduckgo.com/">
      <input type="text" id="search" name="q" placeholder="Google" autocomplete="off" onkeydown="javascript:doTheBang(event,this.value);" onkeyup="javascript:doTheBang(event,this.value);">
      <input type="submit" onclick="javascript:doTheBang(event,document.getElementById(&quot;search&quot;).value);" value="Submit">
    </form>
    <p id="tip">Try "!ptp" or "!yt everybody do the flop"</p>
    <a href="#" onclick="javascript:bangList();" id="listtoggle">List of available bangs</a>
    <p id="banglist"></p>
    <script>var bangPrefix="!";var currentBang="g";document.getElementById("tip").innerHTML=document.getElementById("tip").innerHTML.replace(/!/g,bangPrefix);document.getElementById("listtoggle").innerHTML+=" ("+Object.keys(bangs).length+")";function doTheBang(event,search){var bang;var searchBar=document.getElementById("search");var key=event.keyCode||event.which;var qlist;if(key===32){qList=search.split(" ");if(qList[0].substring(0,bangPrefix.length)===bangPrefix){bang=qList[0].substr(bangPrefix.length);if(bangs[bang]){currentBang=bang;searchBar.placeholder=bangs[bang]['n'];searchBar.value=search.replace(qList[0],"").trim();event.preventDefault()}}}else if(key===13||event.type==="click"){if(bang===undefined){bang=currentBang}qList=search.split(" ");if(qList[0].substring(0,bangPrefix.length)===bangPrefix){if(bangs[qList[0].substr(bangPrefix.length)]){bang=qList[0].substr(bangPrefix.length)}}if(bangPrefix+bang===search||search===""){window.location=bangs[bang]["h"].replace(/{{qe}}/g,"").replace(/{{qp}}/g,"").trim()}else{window.location=bangs[bang]["s"].replace(/{{qe}}/g,encodeURIComponent(search.replace(bangPrefix+bang,""))).replace(/{{qp}}/g,search.replace(bangPrefix+bang,"").replace(/ /g,"+")).trim()}}}function bangList(){var list=document.getElementById("banglist");var listhtml="";if(list.innerHTML===""){Object.keys(bangs).map(function(objectKey,index){listhtml+=bangPrefix+objectKey+" - <a href=\""+bangs[objectKey]["h"]+"\">"+bangs[objectKey]["n"]+"</a><br>"});list.innerHTML=listhtml}else if(list.offsetWidth>0||list.offsetHeight>0){list.style.display="none"}else{list.removeAttribute("style")}}</script>
  </body>
</html>
